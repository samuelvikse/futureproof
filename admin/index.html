<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel — FutureProof</title>
  <meta name="robots" content="noindex, nofollow">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">

  <!-- Adobe Fonts: Sofia Pro -->
  <link rel="stylesheet" href="https://use.typekit.net/ngj4ynz.css">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --color-primary: #f4e8d8;
      --color-secondary: #53654e;
      --color-dark: #3d4d42;
      --color-accent: #7a9a6e;
      --color-success: #4ade80;
      --color-warning: #fbbf24;
      --color-error: #f87171;
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);
      --shadow-md: 0 8px 30px rgba(0,0,0,0.15);
      --shadow-lg: 0 20px 50px rgba(0,0,0,0.25);
      --transition-fast: 0.15s ease;
      --transition-normal: 0.3s ease;
      --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    body {
      font-family: "sofia-pro", -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(145deg, #2d3d32 0%, var(--color-dark) 50%, #3a4a3f 100%);
      color: var(--color-primary);
      min-height: 100vh;
      overflow-x: hidden;
    }

    body.login-view {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Noise texture overlay */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
      opacity: 0.03;
      pointer-events: none;
      z-index: 0;
    }

    /* ==================== LOGIN SCREEN ==================== */
    .login-container {
      position: relative;
      z-index: 1;
      max-width: 420px;
      width: 100%;
      margin: 20px;
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .login-card {
      background: rgba(244, 232, 216, 0.04);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(244, 232, 216, 0.08);
      border-radius: var(--radius-lg);
      padding: 48px 40px;
      box-shadow: var(--shadow-lg);
    }

    .login-logo {
      display: flex;
      justify-content: center;
      margin-bottom: 32px;
    }

    .login-logo img {
      height: 32px;
      opacity: 0.9;
    }

    .login-header {
      text-align: center;
      margin-bottom: 32px;
    }

    .login-header h1 {
      font-size: 1.75rem;
      font-weight: 600;
      letter-spacing: -0.5px;
      margin-bottom: 8px;
    }

    .login-header p {
      color: rgba(244, 232, 216, 0.5);
      font-size: 0.9rem;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-size: 0.85rem;
      font-weight: 500;
      color: rgba(244, 232, 216, 0.7);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .input-wrapper {
      position: relative;
    }

    .input-wrapper svg {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      stroke: rgba(244, 232, 216, 0.3);
      transition: stroke var(--transition-normal);
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 14px 16px 14px 48px;
      background: rgba(244, 232, 216, 0.06);
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-md);
      color: var(--color-primary);
      font-family: inherit;
      font-size: 0.95rem;
      transition: all var(--transition-normal);
    }

    .form-group input:not(.input-wrapper input),
    .form-group textarea {
      padding-left: 16px;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: rgba(244, 232, 216, 0.3);
      background: rgba(244, 232, 216, 0.1);
      box-shadow: 0 0 0 3px rgba(244, 232, 216, 0.05);
    }

    .form-group input:focus + svg,
    .input-wrapper:focus-within svg {
      stroke: rgba(244, 232, 216, 0.6);
    }

    .form-group input::placeholder {
      color: rgba(244, 232, 216, 0.3);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 120px;
      line-height: 1.6;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 24px;
      border-radius: var(--radius-md);
      font-family: inherit;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-normal);
      border: none;
      text-decoration: none;
    }

    .btn-primary {
      background: var(--color-primary);
      color: var(--color-secondary);
      box-shadow: 0 4px 15px rgba(244, 232, 216, 0.2);
    }

    .btn-primary:hover {
      background: #fff;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(244, 232, 216, 0.3);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-secondary {
      background: rgba(244, 232, 216, 0.08);
      border: 1px solid rgba(244, 232, 216, 0.15);
      color: var(--color-primary);
    }

    .btn-secondary:hover {
      background: rgba(244, 232, 216, 0.15);
      border-color: rgba(244, 232, 216, 0.25);
    }

    .btn-icon {
      width: 40px;
      height: 40px;
      padding: 0;
      background: rgba(244, 232, 216, 0.06);
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-sm);
      color: var(--color-primary);
    }

    .btn-icon:hover {
      background: rgba(244, 232, 216, 0.12);
      border-color: rgba(244, 232, 216, 0.2);
    }

    .btn-icon.danger:hover {
      background: rgba(248, 113, 113, 0.15);
      border-color: rgba(248, 113, 113, 0.3);
      color: var(--color-error);
    }

    .btn-full {
      width: 100%;
    }

    .btn-loading {
      position: relative;
      color: transparent !important;
      pointer-events: none;
    }

    .btn-loading::after {
      content: '';
      position: absolute;
      width: 18px;
      height: 18px;
      border: 2px solid rgba(83, 101, 78, 0.3);
      border-top-color: var(--color-secondary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Error Message */
    .error-message {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.2);
      color: var(--color-error);
      padding: 12px 16px;
      border-radius: var(--radius-md);
      margin-bottom: 20px;
      font-size: 0.9rem;
      opacity: 0;
      transform: translateY(-10px);
      transition: all var(--transition-normal);
      pointer-events: none;
    }

    .error-message.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .error-message svg {
      flex-shrink: 0;
      width: 18px;
      height: 18px;
    }

    /* ==================== ADMIN DASHBOARD ==================== */
    .admin-container {
      display: none;
      position: relative;
      z-index: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px;
      animation: fadeIn 0.4s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .admin-container.show {
      display: block;
    }

    /* Admin Header */
    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      padding-bottom: 24px;
      border-bottom: 1px solid rgba(244, 232, 216, 0.08);
      flex-wrap: wrap;
      gap: 20px;
    }

    .admin-brand {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .admin-logo {
      height: 28px;
      opacity: 0.9;
    }

    .admin-title {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .admin-title h1 {
      font-size: 1.5rem;
      font-weight: 600;
      letter-spacing: -0.5px;
    }

    .admin-title span {
      font-size: 0.8rem;
      color: rgba(244, 232, 216, 0.4);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .admin-actions {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .user-badge {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 16px;
      background: rgba(244, 232, 216, 0.05);
      border-radius: 30px;
      font-size: 0.85rem;
      color: rgba(244, 232, 216, 0.6);
    }

    .user-badge .avatar {
      width: 28px;
      height: 28px;
      background: linear-gradient(135deg, var(--color-secondary), var(--color-accent));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--color-primary);
    }

    /* Stats Bar */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-bottom: 32px;
    }

    .stat-card {
      background: rgba(244, 232, 216, 0.04);
      border: 1px solid rgba(244, 232, 216, 0.06);
      border-radius: var(--radius-md);
      padding: 20px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      transition: all var(--transition-normal);
    }

    .stat-card:hover {
      border-color: rgba(244, 232, 216, 0.12);
      transform: translateY(-2px);
    }

    .stat-icon {
      width: 44px;
      height: 44px;
      background: rgba(244, 232, 216, 0.08);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-icon svg {
      width: 22px;
      height: 22px;
      stroke: var(--color-primary);
      opacity: 0.6;
    }

    .stat-info h3 {
      font-size: 1.75rem;
      font-weight: 700;
      letter-spacing: -1px;
      line-height: 1;
    }

    .stat-info p {
      font-size: 0.8rem;
      color: rgba(244, 232, 216, 0.5);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }

    /* Projects Section */
    .projects-section {
      margin-bottom: 40px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    .section-header h2 {
      font-size: 1.1rem;
      font-weight: 600;
      color: rgba(244, 232, 216, 0.7);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* Projects Grid */
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
      gap: 20px;
    }

    .project-card {
      background: rgba(244, 232, 216, 0.03);
      border: 1px solid rgba(244, 232, 216, 0.08);
      border-radius: var(--radius-lg);
      overflow: hidden;
      transition: all var(--transition-normal);
      animation: cardIn 0.4s ease-out backwards;
    }

    .project-card:nth-child(1) { animation-delay: 0.05s; }
    .project-card:nth-child(2) { animation-delay: 0.1s; }
    .project-card:nth-child(3) { animation-delay: 0.15s; }
    .project-card:nth-child(4) { animation-delay: 0.2s; }
    .project-card:nth-child(5) { animation-delay: 0.25s; }
    .project-card:nth-child(6) { animation-delay: 0.3s; }

    @keyframes cardIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .project-card:hover {
      border-color: rgba(244, 232, 216, 0.15);
      transform: translateY(-4px);
      box-shadow: var(--shadow-md);
    }

    .project-image {
      position: relative;
      height: 180px;
      background: linear-gradient(135deg, rgba(244, 232, 216, 0.08), rgba(244, 232, 216, 0.02));
      overflow: hidden;
    }

    .project-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform var(--transition-slow);
    }

    .project-card:hover .project-image img {
      transform: scale(1.05);
    }

    .project-image-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: rgba(244, 232, 216, 0.2);
    }

    .project-image-placeholder svg {
      width: 48px;
      height: 48px;
    }

    .project-badges {
      position: absolute;
      top: 12px;
      left: 12px;
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .badge {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.65rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      backdrop-filter: blur(10px);
    }

    .badge-featured {
      background: rgba(251, 191, 36, 0.9);
      color: #1a1a1a;
    }

    .badge-homepage {
      background: rgba(74, 222, 128, 0.9);
      color: #1a1a1a;
    }

    .project-number {
      position: absolute;
      bottom: 12px;
      right: 12px;
      font-size: 3rem;
      font-weight: 800;
      color: rgba(244, 232, 216, 0.08);
      line-height: 1;
    }

    .project-content {
      padding: 24px;
    }

    .project-meta {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 12px;
    }

    .project-tags {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .project-tag {
      font-size: 0.65rem;
      font-weight: 500;
      color: rgba(244, 232, 216, 0.5);
      padding: 4px 10px;
      background: rgba(244, 232, 216, 0.06);
      border-radius: 20px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .project-actions {
      display: flex;
      gap: 6px;
    }

    .project-card h3 {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: -0.3px;
      margin-bottom: 8px;
      line-height: 1.3;
    }

    .project-card p {
      font-size: 0.875rem;
      color: rgba(244, 232, 216, 0.55);
      line-height: 1.6;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .project-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 16px;
      font-size: 0.8rem;
      color: rgba(244, 232, 216, 0.4);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    .project-link:hover {
      color: var(--color-primary);
    }

    .project-link svg {
      width: 14px;
      height: 14px;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 80px 40px;
      background: rgba(244, 232, 216, 0.02);
      border: 2px dashed rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-lg);
    }

    .empty-state svg {
      width: 64px;
      height: 64px;
      stroke: rgba(244, 232, 216, 0.2);
      margin-bottom: 20px;
    }

    .empty-state h3 {
      font-size: 1.25rem;
      margin-bottom: 8px;
      color: rgba(244, 232, 216, 0.7);
    }

    .empty-state p {
      color: rgba(244, 232, 216, 0.4);
      margin-bottom: 24px;
    }

    /* ==================== MODAL ==================== */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      z-index: 1000;
      padding: 20px;
      overflow-y: auto;
    }

    .modal.show {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      animation: modalIn 0.3s ease-out;
    }

    @keyframes modalIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: linear-gradient(145deg, #3a4a3f, var(--color-dark));
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-lg);
      padding: 0;
      max-width: 640px;
      width: 100%;
      margin: 40px 0;
      box-shadow: var(--shadow-lg);
      animation: modalContentIn 0.4s ease-out;
    }

    @keyframes modalContentIn {
      from { opacity: 0; transform: translateY(30px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 24px 32px;
      border-bottom: 1px solid rgba(244, 232, 216, 0.08);
    }

    .modal-header h2 {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: -0.3px;
    }

    .close-btn {
      width: 36px;
      height: 36px;
      background: rgba(244, 232, 216, 0.06);
      border: none;
      border-radius: var(--radius-sm);
      color: var(--color-primary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-normal);
    }

    .close-btn:hover {
      background: rgba(244, 232, 216, 0.12);
      transform: rotate(90deg);
    }

    .close-btn svg {
      width: 18px;
      height: 18px;
    }

    .modal-body {
      padding: 32px;
    }

    /* Image Preview */
    .image-preview-container {
      margin-top: 12px;
    }

    .image-preview {
      width: 100%;
      height: 160px;
      background: rgba(244, 232, 216, 0.04);
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-md);
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .image-preview-placeholder {
      color: rgba(244, 232, 216, 0.3);
      font-size: 0.85rem;
      text-align: center;
    }

    .image-preview-placeholder svg {
      width: 32px;
      height: 32px;
      margin-bottom: 8px;
      opacity: 0.5;
    }

    /* Image Upload Area */
    .image-upload-area {
      width: 100%;
      border: 2px dashed rgba(244, 232, 216, 0.2);
      border-radius: var(--radius-md);
      padding: 24px;
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-fast);
      background: rgba(244, 232, 216, 0.02);
    }

    .image-upload-area:hover,
    .image-upload-area.dragover {
      border-color: var(--color-accent);
      background: rgba(122, 154, 110, 0.1);
    }

    .upload-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: rgba(244, 232, 216, 0.5);
    }

    .upload-content svg {
      width: 40px;
      height: 40px;
      opacity: 0.6;
    }

    .upload-content span {
      font-size: 0.95rem;
    }

    .upload-content small {
      font-size: 0.8rem;
      opacity: 0.6;
    }

    .upload-progress {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: var(--color-accent);
    }

    .progress-bar {
      width: 100%;
      height: 4px;
      background: rgba(244, 232, 216, 0.1);
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: var(--color-accent);
      width: 0%;
      transition: width 0.3s ease;
      animation: progress-pulse 1.5s ease-in-out infinite;
    }

    @keyframes progress-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    .image-url-fallback {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 12px;
      font-size: 0.85rem;
      color: rgba(244, 232, 216, 0.5);
    }

    .image-url-fallback input {
      flex: 1;
      padding: 8px 12px;
      font-size: 0.85rem;
    }

    /* Checkbox Styling */
    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: rgba(244, 232, 216, 0.04);
      border: 1px solid rgba(244, 232, 216, 0.08);
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all var(--transition-fast);
    }

    .checkbox-item:hover {
      background: rgba(244, 232, 216, 0.08);
      border-color: rgba(244, 232, 216, 0.15);
    }

    .checkbox-item.checked {
      background: rgba(122, 154, 110, 0.15);
      border-color: rgba(122, 154, 110, 0.3);
    }

    .checkbox-item input[type="checkbox"] {
      display: none;
    }

    .checkbox-custom {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(244, 232, 216, 0.3);
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--transition-fast);
      flex-shrink: 0;
    }

    .checkbox-item.checked .checkbox-custom {
      background: var(--color-accent);
      border-color: var(--color-accent);
    }

    .checkbox-custom svg {
      width: 12px;
      height: 12px;
      stroke: var(--color-primary);
      opacity: 0;
      transform: scale(0.5);
      transition: all var(--transition-fast);
    }

    .checkbox-item.checked .checkbox-custom svg {
      opacity: 1;
      transform: scale(1);
    }

    .checkbox-label {
      font-size: 0.9rem;
      color: rgba(244, 232, 216, 0.8);
    }

    /* Toggle Switch */
    .toggle-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .toggle-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      background: rgba(244, 232, 216, 0.04);
      border: 1px solid rgba(244, 232, 216, 0.08);
      border-radius: var(--radius-md);
    }

    .toggle-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .toggle-info span {
      font-size: 0.95rem;
      font-weight: 500;
    }

    .toggle-info small {
      font-size: 0.8rem;
      color: rgba(244, 232, 216, 0.4);
    }

    .toggle-switch {
      position: relative;
      width: 48px;
      height: 26px;
      cursor: pointer;
    }

    .toggle-switch input {
      display: none;
    }

    .toggle-slider {
      position: absolute;
      inset: 0;
      background: rgba(244, 232, 216, 0.15);
      border-radius: 30px;
      transition: all var(--transition-normal);
    }

    .toggle-slider::before {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      left: 3px;
      bottom: 3px;
      background: var(--color-primary);
      border-radius: 50%;
      transition: all var(--transition-normal);
    }

    .toggle-switch input:checked + .toggle-slider {
      background: var(--color-accent);
    }

    .toggle-switch input:checked + .toggle-slider::before {
      transform: translateX(22px);
    }

    .form-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      padding: 24px 32px;
      border-top: 1px solid rgba(244, 232, 216, 0.08);
      background: rgba(0, 0, 0, 0.1);
    }

    /* ==================== TOAST NOTIFICATIONS ==================== */
    .toast-container {
      position: fixed;
      bottom: 24px;
      right: 24px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 2000;
    }

    .toast {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 16px 20px;
      background: var(--color-dark);
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      min-width: 300px;
      animation: toastIn 0.4s ease-out;
    }

    @keyframes toastIn {
      from { opacity: 0; transform: translateX(100px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .toast.removing {
      animation: toastOut 0.3s ease-in forwards;
    }

    @keyframes toastOut {
      to { opacity: 0; transform: translateX(100px); }
    }

    .toast-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .toast-icon svg {
      width: 14px;
      height: 14px;
    }

    .toast.success .toast-icon {
      background: rgba(74, 222, 128, 0.2);
      color: var(--color-success);
    }

    .toast.error .toast-icon {
      background: rgba(248, 113, 113, 0.2);
      color: var(--color-error);
    }

    .toast.warning .toast-icon {
      background: rgba(251, 191, 36, 0.2);
      color: var(--color-warning);
    }

    .toast-content {
      flex: 1;
    }

    .toast-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .toast-message {
      font-size: 0.8rem;
      color: rgba(244, 232, 216, 0.6);
    }

    /* ==================== LOADING OVERLAY ==================== */
    .loading-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all var(--transition-normal);
    }

    .loading-overlay.show {
      opacity: 1;
      visibility: visible;
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 3px solid rgba(244, 232, 216, 0.1);
      border-top-color: var(--color-primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    /* ==================== BACK BUTTON ==================== */
    .back-btn {
      position: fixed;
      top: 30px;
      left: 30px;
      width: 48px;
      height: 48px;
      background: rgba(244, 232, 216, 0.06);
      border: 1px solid rgba(244, 232, 216, 0.1);
      border-radius: var(--radius-md);
      color: var(--color-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--transition-normal);
      text-decoration: none;
      z-index: 100;
    }

    .back-btn:hover {
      background: rgba(244, 232, 216, 0.12);
      border-color: rgba(244, 232, 216, 0.2);
      transform: translateX(-4px);
    }

    .back-btn svg {
      width: 20px;
      height: 20px;
    }

    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 768px) {
      .admin-container {
        padding: 20px;
      }

      .admin-header {
        flex-direction: column;
        align-items: stretch;
        gap: 16px;
      }

      .admin-actions {
        justify-content: space-between;
      }

      .user-badge {
        display: none;
      }

      .stats-bar {
        grid-template-columns: repeat(2, 1fr);
      }

      .projects-grid {
        grid-template-columns: 1fr;
      }

      .checkbox-group {
        grid-template-columns: 1fr;
      }

      .modal-content {
        margin: 20px 0;
      }

      .modal-body {
        padding: 24px 20px;
      }

      .form-actions {
        padding: 20px;
        flex-direction: column;
      }

      .form-actions .btn {
        width: 100%;
      }

      .back-btn {
        top: 15px;
        left: 15px;
        width: 40px;
        height: 40px;
      }

      .toast-container {
        left: 16px;
        right: 16px;
        bottom: 16px;
      }

      .toast {
        min-width: auto;
      }
    }
  </style>
</head>
<body class="login-view">
  <!-- Back to Homepage Button -->
  <a href="/" class="back-btn" aria-label="Back to homepage" title="Back to homepage">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M19 12H5M12 19l-7-7 7-7"/>
    </svg>
  </a>

  <!-- Login Screen -->
  <div class="login-container" id="loginContainer">
    <div class="login-card">
      <div class="login-logo">
        <img src="/assets/logo.svg" alt="FutureProof">
      </div>

      <div class="login-header">
        <h1>Welcome back</h1>
        <p>Sign in to manage your projects</p>
      </div>

      <div class="error-message" id="errorMessage">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"/>
          <line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
        <span id="errorText">Invalid credentials. Please try again.</span>
      </div>

      <form id="loginForm">
        <div class="form-group">
          <label for="email">Email</label>
          <div class="input-wrapper">
            <input type="email" id="email" required autocomplete="email" placeholder="your@email.com">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
              <polyline points="22,6 12,13 2,6"/>
            </svg>
          </div>
        </div>

        <div class="form-group">
          <label for="password">Password</label>
          <div class="input-wrapper">
            <input type="password" id="password" required autocomplete="current-password" placeholder="••••••••">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
            </svg>
          </div>
        </div>

        <button type="submit" class="btn btn-primary btn-full" id="loginBtn">
          Sign In
        </button>
      </form>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div class="admin-container" id="adminContainer">
    <div class="admin-header">
      <div class="admin-brand">
        <img src="/assets/logo.svg" alt="FutureProof" class="admin-logo">
        <div class="admin-title">
          <h1>Project Manager</h1>
          <span>FutureProof Admin</span>
        </div>
      </div>
      <div class="admin-actions">
        <div class="user-badge">
          <div class="avatar" id="userAvatar">A</div>
          <span id="userEmail">admin</span>
        </div>
        <button class="btn btn-primary" id="addProjectBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Add Project
        </button>
        <button class="btn btn-secondary" id="logoutBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          Logout
        </button>
      </div>
    </div>

    <!-- Stats -->
    <div class="stats-bar">
      <div class="stat-card">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
          </svg>
        </div>
        <div class="stat-info">
          <h3 id="totalProjects">0</h3>
          <p>Total Projects</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
          </svg>
        </div>
        <div class="stat-info">
          <h3 id="featuredCount">0</h3>
          <p>Featured</p>
        </div>
      </div>
      <div class="stat-card">
        <div class="stat-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9 22 9 12 15 12 15 22"/>
          </svg>
        </div>
        <div class="stat-info">
          <h3 id="homepageCount">0</h3>
          <p>On Homepage</p>
        </div>
      </div>
    </div>

    <!-- Projects Section -->
    <div class="projects-section">
      <div class="section-header">
        <h2>All Projects</h2>
      </div>
      <div class="projects-grid" id="projectsGrid">
        <!-- Projects will be loaded here -->
      </div>
    </div>
  </div>

  <!-- Add/Edit Project Modal -->
  <div class="modal" id="projectModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle">Add Project</h2>
        <button class="close-btn" id="closeModal">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>

      <form id="projectForm">
        <div class="modal-body">
          <input type="hidden" id="projectId">

          <div class="form-group">
            <label for="projectName">Project Name *</label>
            <input type="text" id="projectName" required placeholder="Enter project name">
          </div>

          <div class="form-group">
            <label for="projectDescription">Description *</label>
            <textarea id="projectDescription" required placeholder="Describe the project..."></textarea>
          </div>

          <div class="form-group">
            <label>Categories *</label>
            <div class="checkbox-group" id="categoryGroup">
              <label class="checkbox-item" data-value="branding">
                <input type="checkbox" id="catBranding" value="branding">
                <span class="checkbox-custom">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                </span>
                <span class="checkbox-label">Branding</span>
              </label>
              <label class="checkbox-item" data-value="identity">
                <input type="checkbox" id="catIdentity" value="identity">
                <span class="checkbox-custom">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                </span>
                <span class="checkbox-label">Visual Identity</span>
              </label>
              <label class="checkbox-item" data-value="website">
                <input type="checkbox" id="catWebsite" value="website">
                <span class="checkbox-custom">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                </span>
                <span class="checkbox-label">Website</span>
              </label>
              <label class="checkbox-item" data-value="marketing">
                <input type="checkbox" id="catMarketing" value="marketing">
                <span class="checkbox-custom">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                </span>
                <span class="checkbox-label">Marketing</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="projectLink">Project URL</label>
            <input type="url" id="projectLink" placeholder="https://example.com">
          </div>

          <div class="form-group">
            <label>Project Image</label>
            <div class="image-upload-area" id="imageUploadArea">
              <input type="file" id="imageFileInput" accept="image/*" hidden>
              <div class="upload-content" id="uploadContent">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="17 8 12 3 7 8"/>
                  <line x1="12" y1="3" x2="12" y2="15"/>
                </svg>
                <span>Click or drag image here</span>
                <small>PNG, JPG up to 5MB</small>
              </div>
              <div class="upload-progress" id="uploadProgress" style="display: none;">
                <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                <span>Uploading...</span>
              </div>
            </div>
            <div class="image-url-fallback">
              <span>or enter URL:</span>
              <input type="text" id="projectImage" placeholder="https://...">
            </div>
            <div class="image-preview-container">
              <div class="image-preview" id="imagePreview">
                <div class="image-preview-placeholder">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <polyline points="21 15 16 10 5 21"/>
                  </svg>
                  <div>Image preview</div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label>Display Options</label>
            <div class="toggle-group">
              <div class="toggle-item">
                <div class="toggle-info">
                  <span>Featured Project</span>
                  <small>Highlights project with a special badge</small>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" id="projectFeatured">
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div class="toggle-item">
                <div class="toggle-info">
                  <span>Show on Homepage</span>
                  <small>Display in the homepage portfolio section</small>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" id="projectHomepage">
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
          <button type="submit" class="btn btn-primary" id="saveBtn">Save Project</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
  </div>

  <script type="module">
    // Firebase imports
    import {
      getProjects,
      addProject,
      updateProject,
      deleteProject as firebaseDeleteProject,
      uploadProjectImage,
      login,
      logout,
      onAuthChange
    } from '/js/firebase-config.js';

    // Elements
    const loginContainer = document.getElementById('loginContainer');
    const adminContainer = document.getElementById('adminContainer');
    const loginForm = document.getElementById('loginForm');
    const loginBtn = document.getElementById('loginBtn');
    const errorMessage = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');
    const logoutBtn = document.getElementById('logoutBtn');
    const addProjectBtn = document.getElementById('addProjectBtn');
    const projectModal = document.getElementById('projectModal');
    const projectForm = document.getElementById('projectForm');
    const closeModal = document.getElementById('closeModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const saveBtn = document.getElementById('saveBtn');
    const projectsGrid = document.getElementById('projectsGrid');
    const modalTitle = document.getElementById('modalTitle');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const toastContainer = document.getElementById('toastContainer');
    const imageInput = document.getElementById('projectImage');
    const imagePreview = document.getElementById('imagePreview');
    const userAvatar = document.getElementById('userAvatar');
    const userEmail = document.getElementById('userEmail');
    const imageUploadArea = document.getElementById('imageUploadArea');
    const imageFileInput = document.getElementById('imageFileInput');
    const uploadContent = document.getElementById('uploadContent');
    const uploadProgress = document.getElementById('uploadProgress');
    const progressFill = document.getElementById('progressFill');

    // Projects data
    let projects = [];
    let editingProjectId = null;

    // Default projects to seed if database is empty
    const defaultProjects = [
      {
        name: 'Johan Ask Vikse',
        description: 'A refined portfolio website for an established visual artist from Haugesund. Features an elegant gallery showcasing artwork in ink, pencil, and acrylic, along with exhibition history and artist biography.',
        categories: ['website', 'identity'],
        link: 'https://johanaskvikse.no/',
        image: '/assets/images/projects/johanaskvikse.jpg',
        featured: true,
        showOnHomepage: true,
        order: 1
      },
      {
        name: 'Styrke i hver maske',
        description: 'Branding and website for Kristine Vikse\'s therapeutic knitting practice. The design philosophy centers on their belief that knitting is meditation in motion—a tool for nervous system regulation and mental healing.',
        categories: ['branding', 'identity', 'website'],
        link: 'https://styrkeihvermaske.no/',
        image: '/assets/images/projects/styrke-i-hver-maske.jpg',
        featured: true,
        showOnHomepage: true,
        order: 2
      }
    ];

    // Toast notification system
    function showToast(type, title, message) {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;

      const icons = {
        success: '<polyline points="20 6 9 17 4 12"/>',
        error: '<line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>',
        warning: '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>'
      };

      toast.innerHTML = `
        <div class="toast-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">${icons[type]}</svg>
        </div>
        <div class="toast-content">
          <div class="toast-title">${title}</div>
          <div class="toast-message">${message}</div>
        </div>
      `;

      toastContainer.appendChild(toast);

      setTimeout(() => {
        toast.classList.add('removing');
        setTimeout(() => toast.remove(), 300);
      }, 4000);
    }

    // Loading state
    function setLoading(loading) {
      loadingOverlay.classList.toggle('show', loading);
    }

    // Update stats
    function updateStats() {
      document.getElementById('totalProjects').textContent = projects.length;
      document.getElementById('featuredCount').textContent = projects.filter(p => p.featured).length;
      document.getElementById('homepageCount').textContent = projects.filter(p => p.showOnHomepage).length;
    }

    // Seed database with default projects if empty
    async function seedDatabaseIfEmpty() {
      try {
        const existingProjects = await getProjects();
        if (existingProjects.length === 0) {
          for (const project of defaultProjects) {
            await addProject(project);
          }
          showToast('success', 'Welcome!', 'Default projects have been added.');
          return true;
        }
        return false;
      } catch (error) {
        console.error('Error seeding database:', error);
        return false;
      }
    }

    // Load projects from Firestore
    async function loadProjectsFromFirestore() {
      try {
        setLoading(true);
        await seedDatabaseIfEmpty();
        projects = await getProjects();
        renderProjects();
        updateStats();
      } catch (error) {
        console.error('Error loading projects:', error);
        showToast('error', 'Error', 'Failed to load projects.');
      } finally {
        setLoading(false);
      }
    }

    // Render projects
    function renderProjects() {
      if (projects.length === 0) {
        projectsGrid.innerHTML = `
          <div class="empty-state" style="grid-column: 1 / -1;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/>
              <line x1="12" y1="11" x2="12" y2="17"/>
              <line x1="9" y1="14" x2="15" y2="14"/>
            </svg>
            <h3>No projects yet</h3>
            <p>Get started by adding your first project</p>
            <button class="btn btn-primary" onclick="document.getElementById('addProjectBtn').click()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19"/>
                <line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              Add Project
            </button>
          </div>
        `;
        return;
      }

      const categoryLabels = {
        branding: 'Branding',
        identity: 'Visual Identity',
        website: 'Website',
        marketing: 'Marketing'
      };

      projectsGrid.innerHTML = projects.map((project, index) => `
        <div class="project-card">
          <div class="project-image">
            ${project.image
              ? `<img src="${project.image}" alt="${project.name}" onerror="this.parentElement.innerHTML='<div class=\\'project-image-placeholder\\'><svg viewBox=\\'0 0 24 24\\' fill=\\'none\\' stroke=\\'currentColor\\' stroke-width=\\'1.5\\'><rect x=\\'3\\' y=\\'3\\' width=\\'18\\' height=\\'18\\' rx=\\'2\\'/><circle cx=\\'8.5\\' cy=\\'8.5\\' r=\\'1.5\\'/><polyline points=\\'21 15 16 10 5 21\\'/></svg></div>'">`
              : `<div class="project-image-placeholder">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <circle cx="8.5" cy="8.5" r="1.5"/>
                    <polyline points="21 15 16 10 5 21"/>
                  </svg>
                </div>`
            }
            <div class="project-badges">
              ${project.featured ? '<span class="badge badge-featured">Featured</span>' : ''}
              ${project.showOnHomepage ? '<span class="badge badge-homepage">Homepage</span>' : ''}
            </div>
            <span class="project-number">${String(index + 1).padStart(2, '0')}</span>
          </div>
          <div class="project-content">
            <div class="project-meta">
              <div class="project-tags">
                ${project.categories.map(cat => `<span class="project-tag">${categoryLabels[cat] || cat}</span>`).join('')}
              </div>
              <div class="project-actions">
                <button class="btn-icon" onclick="editProject('${project.id}')" title="Edit">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
                  </svg>
                </button>
                <button class="btn-icon danger" onclick="deleteProjectHandler('${project.id}')" title="Delete">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                    <line x1="10" y1="11" x2="10" y2="17"/>
                    <line x1="14" y1="11" x2="14" y2="17"/>
                  </svg>
                </button>
              </div>
            </div>
            <h3>${project.name}</h3>
            <p>${project.description}</p>
            ${project.link && project.link !== '#' ? `
              <a href="${project.link}" target="_blank" rel="noopener noreferrer" class="project-link">
                Visit site
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                  <polyline points="15 3 21 3 21 9"/>
                  <line x1="10" y1="14" x2="21" y2="3"/>
                </svg>
              </a>
            ` : ''}
          </div>
        </div>
      `).join('');
    }

    // Checkbox styling
    document.querySelectorAll('.checkbox-item').forEach(item => {
      const checkbox = item.querySelector('input[type="checkbox"]');
      checkbox.addEventListener('change', () => {
        item.classList.toggle('checked', checkbox.checked);
      });
    });

    // Image preview
    imageInput.addEventListener('input', () => {
      const value = imageInput.value.trim();
      if (value) {
        imagePreview.innerHTML = `<img src="${value}" alt="Preview" onerror="this.parentElement.innerHTML='<div class=\\'image-preview-placeholder\\'><svg viewBox=\\'0 0 24 24\\' fill=\\'none\\' stroke=\\'currentColor\\' stroke-width=\\'1.5\\'><circle cx=\\'12\\' cy=\\'12\\' r=\\'10\\'/><line x1=\\'12\\' y1=\\'8\\' x2=\\'12\\' y2=\\'12\\'/><line x1=\\'12\\' y1=\\'16\\' x2=\\'12.01\\' y2=\\'16\\'/></svg><div>Invalid image path</div></div>'">`;
      } else {
        imagePreview.innerHTML = `
          <div class="image-preview-placeholder">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <polyline points="21 15 16 10 5 21"/>
            </svg>
            <div>Image preview</div>
          </div>
        `;
      }
    });

    // Image file upload
    imageUploadArea.addEventListener('click', () => imageFileInput.click());
    
    imageUploadArea.addEventListener('dragover', (e) => {
      e.preventDefault();
      imageUploadArea.classList.add('dragover');
    });

    imageUploadArea.addEventListener('dragleave', () => {
      imageUploadArea.classList.remove('dragover');
    });

    imageUploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      imageUploadArea.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if (file && file.type.startsWith('image/')) {
        handleImageUpload(file);
      }
    });

    imageFileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        handleImageUpload(file);
      }
    });

    // Compress and resize image before upload
    async function compressImage(file, maxWidth = 1920, quality = 0.85) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const img = new Image();
          img.onload = () => {
            const canvas = document.createElement('canvas');
            let width = img.width;
            let height = img.height;

            // Calculate new dimensions
            if (width > maxWidth) {
              height = Math.round((height * maxWidth) / width);
              width = maxWidth;
            }

            canvas.width = width;
            canvas.height = height;

            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0, width, height);

            canvas.toBlob((blob) => {
              if (blob) {
                // Create new file with same name
                const compressedFile = new File([blob], file.name.replace(/\.[^.]+$/, '.jpg'), {
                  type: 'image/jpeg',
                  lastModified: Date.now()
                });
                resolve(compressedFile);
              } else {
                reject(new Error('Compression failed'));
              }
            }, 'image/jpeg', quality);
          };
          img.onerror = () => reject(new Error('Failed to load image'));
          img.src = e.target.result;
        };
        reader.onerror = () => reject(new Error('Failed to read file'));
        reader.readAsDataURL(file);
      });
    }

    async function handleImageUpload(file) {
      // Show progress
      uploadContent.style.display = 'none';
      uploadProgress.style.display = 'flex';
      progressFill.style.width = '10%';

      try {
        // Compress image first
        progressFill.style.width = '30%';
        const compressedFile = await compressImage(file);
        
        // Show local preview
        const reader = new FileReader();
        reader.onload = (e) => {
          imagePreview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
        };
        reader.readAsDataURL(compressedFile);

        progressFill.style.width = '60%';

        // Upload compressed image to Firebase Storage
        const downloadURL = await uploadProjectImage(compressedFile);
        
        progressFill.style.width = '100%';
        
        // Set the URL in the input
        imageInput.value = downloadURL;
        
        // Reset upload area after short delay
        setTimeout(() => {
          uploadContent.style.display = 'flex';
          uploadProgress.style.display = 'none';
          progressFill.style.width = '0%';
        }, 500);

        showToast('Image uploaded successfully', 'success');
      } catch (error) {
        console.error('Upload error:', error);
        uploadContent.style.display = 'flex';
        uploadProgress.style.display = 'none';
        progressFill.style.width = '0%';
        showToast('Failed to upload image', 'error');
      }
    }

    // Login
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      loginBtn.classList.add('btn-loading');
      errorMessage.classList.remove('show');

      try {
        await login(email, password);
      } catch (error) {
        console.error('Login error:', error);
        errorText.textContent = error.code === 'auth/invalid-credential'
          ? 'Invalid email or password.'
          : error.message || 'Login failed. Please try again.';
        errorMessage.classList.add('show');
        document.getElementById('password').value = '';
      } finally {
        loginBtn.classList.remove('btn-loading');
      }
    });

    // Logout
    logoutBtn.addEventListener('click', async () => {
      try {
        await logout();
        showToast('success', 'Logged out', 'See you next time!');
      } catch (error) {
        console.error('Logout error:', error);
      }
    });

    // Auth state changes
    onAuthChange((user) => {
      if (user) {
        document.body.classList.remove('login-view');
        loginContainer.style.display = 'none';
        adminContainer.classList.add('show');

        // Update user info
        const email = user.email || 'admin';
        userEmail.textContent = email.split('@')[0];
        userAvatar.textContent = email.charAt(0).toUpperCase();

        loadProjectsFromFirestore();
      } else {
        document.body.classList.add('login-view');
        loginContainer.style.display = 'block';
        adminContainer.classList.remove('show');
        projects = [];
      }
    });

    // Add project
    addProjectBtn.addEventListener('click', () => {
      editingProjectId = null;
      modalTitle.textContent = 'Add Project';
      projectForm.reset();

      // Reset checkbox styling
      document.querySelectorAll('.checkbox-item').forEach(item => {
        item.classList.remove('checked');
      });

      // Reset image preview
      imagePreview.innerHTML = `
        <div class="image-preview-placeholder">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <circle cx="8.5" cy="8.5" r="1.5"/>
            <polyline points="21 15 16 10 5 21"/>
          </svg>
          <div>Image preview</div>
        </div>
      `;

      projectModal.classList.add('show');
    });

    // Edit project
    window.editProject = (id) => {
      const project = projects.find(p => p.id === id);
      if (!project) return;

      editingProjectId = id;
      modalTitle.textContent = 'Edit Project';

      document.getElementById('projectId').value = project.id;
      document.getElementById('projectName').value = project.name;
      document.getElementById('projectDescription').value = project.description;
      document.getElementById('projectLink').value = project.link || '';
      document.getElementById('projectImage').value = project.image || '';
      document.getElementById('projectFeatured').checked = project.featured;
      document.getElementById('projectHomepage').checked = project.showOnHomepage || false;

      // Set categories with styling
      ['branding', 'identity', 'website', 'marketing'].forEach(cat => {
        const checkbox = document.getElementById(`cat${cat.charAt(0).toUpperCase() + cat.slice(1)}`);
        const isChecked = project.categories.includes(cat);
        checkbox.checked = isChecked;
        checkbox.closest('.checkbox-item').classList.toggle('checked', isChecked);
      });

      // Update image preview
      if (project.image) {
        imagePreview.innerHTML = `<img src="${project.image}" alt="Preview">`;
      }

      projectModal.classList.add('show');
    };

    // Delete project
    window.deleteProjectHandler = async (id) => {
      if (confirm('Are you sure you want to delete this project?')) {
        try {
          setLoading(true);
          await firebaseDeleteProject(id);
          await loadProjectsFromFirestore();
          showToast('success', 'Deleted', 'Project has been removed.');
        } catch (error) {
          console.error('Error deleting project:', error);
          showToast('error', 'Error', 'Failed to delete project.');
        } finally {
          setLoading(false);
        }
      }
    };

    // Close modal
    const closeModalFn = () => {
      projectModal.classList.remove('show');
    };

    closeModal.addEventListener('click', closeModalFn);
    cancelBtn.addEventListener('click', closeModalFn);
    projectModal.addEventListener('click', (e) => {
      if (e.target === projectModal) closeModalFn();
    });

    // Save project
    projectForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const categories = [];
      if (document.getElementById('catBranding').checked) categories.push('branding');
      if (document.getElementById('catIdentity').checked) categories.push('identity');
      if (document.getElementById('catWebsite').checked) categories.push('website');
      if (document.getElementById('catMarketing').checked) categories.push('marketing');

      if (categories.length === 0) {
        showToast('warning', 'Validation', 'Please select at least one category.');
        return;
      }

      const projectData = {
        name: document.getElementById('projectName').value,
        description: document.getElementById('projectDescription').value,
        categories: categories,
        link: document.getElementById('projectLink').value || '#',
        image: document.getElementById('projectImage').value || '',
        featured: document.getElementById('projectFeatured').checked,
        showOnHomepage: document.getElementById('projectHomepage').checked,
        order: editingProjectId ? (projects.find(p => p.id === editingProjectId)?.order || 0) : projects.length + 1
      };

      saveBtn.classList.add('btn-loading');

      try {
        if (editingProjectId) {
          await updateProject(editingProjectId, projectData);
          showToast('success', 'Updated', 'Project has been updated.');
        } else {
          await addProject(projectData);
          showToast('success', 'Created', 'New project has been added.');
        }

        await loadProjectsFromFirestore();
        closeModalFn();
        projectForm.reset();
        editingProjectId = null;
      } catch (error) {
        console.error('Error saving project:', error);
        showToast('error', 'Error', 'Failed to save project.');
      } finally {
        saveBtn.classList.remove('btn-loading');
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && projectModal.classList.contains('show')) {
        closeModalFn();
      }
    });
  </script>
</body>
</html>
